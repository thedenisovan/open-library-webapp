(()=>{"use strict";class e{constructor(e=[]){this.users=new Map(e)}checkForExistingUser(e){return this.users.has(e)}validateUserDetails(e,t){const s=[];return e.length<4&&s.push("Username must be at least 4 chars."),t.length<6&&s.push("Password must be at least 6 chars."),this.checkForExistingUser(e)&&s.push("Username not available."),s}addUser(e,t){const s=this.validateUserDetails(e,t);return s.length?{success:!1,errors:s}:(this.users.set(e,t),{success:!0})}signIn(e,t){return this.users.get(e)===t}saveToStorage(e){localStorage.setItem(e,JSON.stringify([...this.users]))}static loadFromStorage(t){const s=localStorage.getItem(t);return s?new e(JSON.parse(s)):new e}}const t={username:document.querySelector("[data-username]"),password:document.querySelector("[data-password]"),signinBtn:document.querySelector("[data-signin]"),registrationBtn:document.querySelector("[data-register]"),mainField:document.querySelector("[data-main-field]"),errorPlaceholder:document.querySelector("[data-error]"),rotationSvg:document.querySelector("[data-rot]")},s={signinPageBtn:document.querySelector("[data-signin-page]"),singUpPageBtn:document.querySelector("[data-signup-page]"),hidden:document.querySelectorAll(".hidden"),visible:document.querySelectorAll(".visible"),foreground:document.querySelector("[data-foreground]"),skipBtn:document.querySelector("[data-skip-registration]")};let r=e.loadFromStorage("userData");function a(e,t,s){e.forEach(e=>e.classList.toggle(t)),e.forEach(e=>e.classList.toggle(s))}function n(){t.username.value="",t.password.value=""}function o(){a(s.hidden,"hidden","visible"),a(s.visible,"hidden","visible"),s.foreground.classList.toggle("beige-bg"),s.foreground.classList.toggle("blue-bg"),n()}r.users.size||(r.addUser("jamal","000000"),r.addUser("marquis","111111"),r.addUser("samantha","222222"),r.saveToStorage("userData")),t.mainField.addEventListener("click",async e=>{e.preventDefault();const s=e.target;if(s.closest("#signin-btn")&&(r.signIn(t.username.value,t.password.value)?window.location="./main.html":(t.errorPlaceholder.textContent="Invalid username or password.",n())),s.closest("#registration-btn")){const e=r.addUser(t.username.value,t.password.value);e.success?(async function(e){e.classList.remove("hidden-svg"),await new Promise(e=>setTimeout(e,1200)),e.classList.add("hidden-svg"),location.reload()}(t.rotationSvg),r.saveToStorage("userData")):t.errorPlaceholder.textContent=e.errors.join(" ")}}),s.singUpPageBtn.addEventListener("click",()=>o()),s.signinPageBtn.addEventListener("click",()=>o()),s.skipBtn.addEventListener("click",()=>window.location="./main.html")})();